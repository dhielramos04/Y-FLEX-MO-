<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Yoga Pose Challenge</title>

<script src="https://cdn.tailwindcss.com"></script>

<!-- TensorFlow -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>

<style>
body { background:#f0fdf4; display:flex; flex-direction:column; align-items:center; padding:20px; }
video, canvas { border:2px solid green; border-radius:10px; }
.pose-photo { max-width:200px; border:2px solid #006400; border-radius:10px; margin-bottom:10px; }
</style>
</head>
<body>

<h1 class="text-3xl font-bold text-green-700 mb-4">AI Yoga Pose Challenge</h1>

<p id="poseName" class="text-xl font-bold text-green-600 mb-2">Click Start</p>
<img id="posePhoto" class="pose-photo" src="">

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
  <video id="video" width="640" height="480" autoplay playsinline></video>
  <canvas id="canvas" width="640" height="480"></canvas>
</div>

<p id="score" class="text-2xl font-bold text-green-700 mb-4">Score: -</p>

<button id="startBtn" class="bg-green-600 text-white px-6 py-2 rounded-xl">Start Pose</button>

<script>

const poses = [
{
name:"Mountain Pose",
photo:"assets/images/mountainpose.jpg",
angles:{leftKnee:180,rightKnee:180,leftElbow:180,rightElbow:180}
},
{
name:"Tree Pose",
photo:"assets/images/treepose.jpg",
angles:{leftKnee:180,rightKnee:60,leftElbow:180,rightElbow:180}
},
{
name:"Warrior I",
photo:"assets/images/warriori.jpg",
angles:{leftKnee:90,rightKnee:180,leftElbow:180,rightElbow:180}
},
{
name:"Warrior II",
photo:"assets/images/warriorii.jpg",
angles:{leftKnee:90,rightKnee:180,leftElbow:180,rightElbow:180}
},
{
name:"Downward Dog",
photo:"assets/images/downwardfacingdog.jpg",
angles:{leftKnee:180,rightKnee:180,leftElbow:180,rightElbow:180}
}
];

let detector;
let currentPose=null;

const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const scoreDisplay=document.getElementById("score");

function angle(a,b,c){
const radians=Math.atan2(c.y-b.y,c.x-b.x)-
Math.atan2(a.y-b.y,a.x-b.x);
let deg=Math.abs(radians*180/Math.PI);
if(deg>180) deg=360-deg;
return deg;
}

function calculateScore(userAngles,refAngles){
let total=0;
let count=0;
for(let key in refAngles){
total+=Math.abs(userAngles[key]-refAngles[key]);
count++;
}
let avg=total/count;
return Math.max(0,100-avg);
}

async function setupCamera(){
const stream=await navigator.mediaDevices.getUserMedia({video:true});
video.srcObject=stream;
await video.play();
}

async function loadModel(){
await tf.setBackend("webgl");
detector=await poseDetection.createDetector(
poseDetection.SupportedModels.MoveNet
);
}

async function detect(){
const poses=await detector.estimatePoses(video);
ctx.clearRect(0,0,canvas.width,canvas.height);

if(poses.length>0 && currentPose){
const k=poses[0].keypoints;

const userAngles={
leftElbow:angle(k[5],k[7],k[9]),
rightElbow:angle(k[6],k[8],k[10]),
leftKnee:angle(k[11],k[13],k[15]),
rightKnee:angle(k[12],k[14],k[16])
};

const score=calculateScore(userAngles,currentPose.angles);
scoreDisplay.innerText="Score: "+Math.floor(score);
}

requestAnimationFrame(detect);
}

document.getElementById("startBtn").addEventListener("click",async()=>{
currentPose=poses[Math.floor(Math.random()*poses.length)];
document.getElementById("poseName").innerText=currentPose.name;
document.getElementById("posePhoto").src=currentPose.photo;

await setupCamera();
await loadModel();
detect();
});

</script>
</body>
</html>




